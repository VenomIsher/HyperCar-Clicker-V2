
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="google-site-verification" content="mccRhxBzff0yfaVWrN3xUgK_eF6opi6fQ1An7wdz4oQ" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hypercar Tycoon Clicker</title>
    <meta name="description" content="Hypercar Tycoon Clicker, un jeu de clicker o√π vous achetez des voitures et am√©liorez votre garage.">
    <meta name="keywords" content="Hypercar, Clicker, Jeu, Voitures, Garage, CPS">
    <meta name="robots" content="index, follow">
    <style>
        body {
            font-family: Verdana, sans-serif;
            text-align: center;
            background: #111;
            color: #eee;
            margin: 0;
            padding: 130px 0 0 0;
        }

        #fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #111;
            color: #fff;
            padding: 5px 0;
            border-bottom: 2px solid #444;
            z-index: 1000;
        }

            #fixed-header h1 {
                margin: 4px 0;
                font-size: 1.5em;
            }

            #fixed-header div {
                font-size: 1em;
                margin: 2px 0;
            }

        .tabs {
            margin: 5px 0;
        }

        .tab-button {
            background: #333;
            border: none;
            padding: 8px 15px;
            margin: 2px;
            color: #eee;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.2s ease;
        }

            .tab-button:hover {
                background: #444;
            }

        .tab-content {
            display: none;
            padding: 20px 10px;
        }

            .tab-content.active {
                display: block;
            }

        #clickArea {
            width: 35vw;
            max-width: 250px;
            height: 35vw;
            max-height: 250px;
            margin: 20px auto;
            background: #222;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10em;
            cursor: pointer;
            margin-top: 10%;
            transition: transform 0.1s ease;
            position: relative;
        }

            #clickArea:active {
                transform: scale(0.9);
            }

        .section {
            border: 1px solid #444;
            margin: 15px auto;
            padding: 10px;
            border-radius: 10px;
            background: #222;
            max-width: 1000px;
        }

        .card, .track-card {
            background: #333;
            border-radius: 12px;
            padding: 4px;
            margin: 6px;
            font-size: 0.9em;
            width: calc(25% - 12px);
            display: inline-block;
            vertical-align: top;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: transform 0.2s ease, background 0.2s ease;
        }

            .card:hover, .track-card:hover {
                transform: scale(1.05);
                background: #444;
            }

            .card img {
                width: 80px;
                height: 80px;
                object-fit: contain;
            }

            .card p, .track-card p {
                margin-top: 8px;
                font-size: 0.85em;
            }

        /* Supprimer le contour bleu et emp√™cher la s√©lection */
        #clickArea, .card {
            outline: none;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        .separator {
            background: #333;
            color: #fff;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            margin: 10px 0;
            border-radius: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.4);
            letter-spacing: 1px;
        }

        .floating-text {
            font-family: Verdana, sans-serif;
            position: absolute;
            font-size: 20px;
            color: white;
            animation: floatUp 1s ease-out forwards;
            pointer-events: none;
            user-select: none;
            transform: translate(-50%, -50%);
        }

        @keyframes floatUp {
            0% {
                transform: translate(-50%, -50%) translateY(0);
                opacity: 1;
            }

            100% {
                transform: translate(-50%, -50%) translateY(-40px);
                opacity: 0;
            }
        }

        @media (max-width: 600px) {
            .card, .track-card {
                width: calc(90% - 12px);
            }
            /* Supprimer le contour bleu et emp√™cher la s√©lection */
            #clickArea, .card {
                outline: none;
                user-select: none;
                -webkit-user-select: none;
                -webkit-touch-callout: none;
            }

                #clickArea:active {
                    transform: scale(0.9);
                }

            #clickArea {
                width: 100vw;
                max-width: 300px;
                height: 100vw;
                max-height: 300px;
                font-size: 11em;
                margin-top: 40%;
            }
        }

        .settings-btn {
            display: block; /* chaque bouton prend une ligne enti√®re */
            width: 80%; /* largeur */
            margin: 10px auto; /* espace entre les boutons */
            padding: 12px 20px; /* taille interne */
            font-size: 1em; /* taille du texte */
            font-weight: bold; /* texte plus marqu√© */
            border: none; /* pas de bordure classique */
            border-radius: 12px; /* coins arrondis */
            background: #333; /* fond */
            color: white; /* couleur texte */
            cursor: pointer; /* curseur main */
            transition: all 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

            .settings-btn:hover {
                background: #444;
                transform: scale(1.05);
            }

        .stats-btn {
            display: block;
            width: 80%;
            margin: 8px auto;
            padding: 10px 18px;
            font-size: 1em;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            background: #333;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

            .stats-btn:hover {
                background: #444;
                transform: scale(1.05);
            }

        .succes-obtenu {
            background-color: #333;
            border: 2px solid green;
            color: white;
        }

        .succes-non-obtenu {
            background-color: #333;
            border: 2px solid red;
            color: white;
        }

        .succes-popup {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #4caf50;
            color: white;
            padding: 18px 32px;
            border-radius: 12px;
            font-size: 1.3em;
            font-weight: bold;
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            z-index: 9999;
            opacity: 0;
            animation: succesFadeInOut 2.2s ease;
            pointer-events: none;
        }

        @keyframes succesFadeInOut {
            0% {
                opacity: 0;
                transform: translateX(-50%) scale(0.8);
            }

            10% {
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }

            90% {
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateX(-50%) scale(0.8);
            }
        }

        .bonus-popup {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, gold, orange);
            color: black;
            font-weight: bold;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 1.2rem;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            animation: popupAnim 3s ease forwards;
            z-index: 9999;
        }

        @keyframes popupAnim {
            0% {
                opacity: 0;
                transform: translate(-50%, 20px);
            }

            20% {
                opacity: 1;
                transform: translate(-50%, 0);
            }

            80% {
                opacity: 1;
                transform: translate(-50%, 0);
            }

            100% {
                opacity: 0;
                transform: translate(-50%, -20px);
            }
        }

        .golden-event {
            display: inline-block;
            animation: goldenPulse 1.5s infinite ease-in-out, goldenSpin 5s linear infinite;
        }

        /* Effet de pulsation (zoom l√©ger) */
        @keyframes goldenPulse {
            0%, 100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }
        }

        /* Effet de rotation continue */
        @keyframes goldenSpin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .highlight-boost {
            color: gold !important;
            font-weight: bold;
            text-shadow: 0 0 5px gold;
        }
    </style>
</head>
<body>

    <div id="fixed-header">
        <h1>üèéÔ∏è Hypercar Tycoon Clicker</h1>
        <div id="credits">Cr√©dits : 0</div>
        <div id="cpcDisplay">Cr√©dits par clic : 1</div>
        <div id="cpsDisplay">CPS total : 0</div>

        <div class="tabs">
            <button class="tab-button" onclick="openTab('main')">üèÅ Principal</button>
            <button class="tab-button" onclick="openTab('carsTab')">üèéÔ∏è Voitures</button>
            <button class="tab-button" onclick="openTab('upgradesTab')">‚öôÔ∏è Am√©liorations</button>
            <button class="tab-button" onclick="openTab('tracksTab')">üèüÔ∏è Circuits</button>
            <button class="tab-button" onclick="openTab('statsTab')"> üìä Stats</button>
            <button class="tab-button" onclick="openTab('settingsTab')"> ‚öôÔ∏è Parametres</button>
        </div>
    </div>

    <div id="main" class="tab-content active">
        <div id="clickArea">üèÜ</div>
    </div>

    <div id="carsTab" class="tab-content">
        <div class="section">
            <h2>Voitures</h2>
            <div id="cars"></div>
        </div>
    </div>

    <div id="upgradesTab" class="tab-content">
        <div class="section">
            <h2>Am√©liorations</h2>
            <div id="upgrades"></div>
        </div>
    </div>

    <div id="tracksTab" class="tab-content">
        <div class="section">
            <h2>Circuits</h2>
            <div id="tracks"></div>
        </div>
    </div>

    <div id="settingsTab" class="tab-content">
        <div class="section">
            <h2>Param√®tres</h2>
            <button class="settings-btn" onclick="resetGame()">üîÑ R√©initialiser la partie</button>
            <button class="settings-btn" onclick="saveGame()">üíæ Sauvegarder manuellement</button>
        </div>
    </div>

    <div id="statsTab" class="tab-content">
        <div class="section">
            <h2>üìä Statistiques</h2>

            <div id="stats-summary" style="margin-bottom:10px; text-align:left;">
                <p>Nombre de clics : <span id="total-clicks">0</span></p>
                <p>CPS : <span id="total-cps">0</span></p>
                <p>CPC : <span id="total-cpc">1</span></p>
                <p>Nombre de roues cliqu√©es : <span id="nbGoldenWheelClicked">0</span></p>
                <p>Nombre de voitures dans le garage : <span id="totalCarsOwned">0</span></p>
                <p>Temps de jeu : <span id="total-time">0s</span></p>
            </div>

            <button class="stats-btn" onclick="showStats('garage')">üèéÔ∏è Mon Garage</button>
            <div id="garage-liste" style="display:none; margin:5px 0 10px 0; text-align:left;"></div>

            <button class="stats-btn" onclick="showStats('success')">üèÜ Succ√®s</button>
            <div id="liste-succes" style="display:none; margin-top:10px; text-align:left;"></div>

            <button class="stats-btn" onclick="showStats('upgrades')">‚öôÔ∏è Am√©liorations acquises</button>
            <div id="liste-upgrades" style="display:none; margin-top:10px; text-align:left;"></div>
        </div>
    </div>

    <script>
        let credits = 0;
        let totalCPS = 0;
        let baseClickValue = 1;
        let totalClicks = 0;
        let totalPlayTime;
        let lastSessionStart = Date.now();
        let goldenEventActive = false;
        let goldenEventTimer;
        let nbGoldenWheelClicked = 0;
        let totalCarsOwned = 0;


        const carsCommunes = [
            { type: "separator", label: "üöó Communes" },
            { name: "Fiat 500 Abarth", baseCost: 25, cps: 1, count: 0, rang: "commune", achete: false },
            { name: "Mini Cooper S", baseCost: 60, cps: 2, count: 0, rang: "commune", achete: false },
            { name: "Renault M√©gane RS", baseCost: 120, cps: 4, count: 0, rang: "commune", achete: false },
            { name: "Hyundai i30 N", baseCost: 200, cps: 7, count: 0, rang: "commune", achete: false },
            { name: "Subaru BRZ", baseCost: 300, cps: 10, count: 0, rang: "commune", achete: false },
            { name: "Volkswagen Golf GTI", baseCost: 450, cps: 14, count: 0, rang: "commune", achete: false },
            { name: "Mazda MX-5", baseCost: 650, cps: 20, count: 0, rang: "commune", achete: false },
            { name: "Porsche Cayman", baseCost: 900, cps: 28, count: 0, rang: "commune", achete: false },
            { name: "Audi R8", baseCost: 1200, cps: 38, count: 0, rang: "commune", achete: false },
            { name: "Mercedes AMG GT", baseCost: 1600, cps: 50, count: 0, rang: "commune", achete: false },
            { name: "Aston Martin Vantage", baseCost: 2100, cps: 65, count: 0, rang: "commune", achete: false },
            { name: "Nissan 370Z", baseCost: 2800, cps: 85, count: 0, rang: "commune", achete: false },
            { name: "Toyota Supra Mk5", baseCost: 3600, cps: 110, count: 0, rang: "commune", achete: false },
            { name: "Ford Mustang GT", baseCost: 4500, cps: 140, count: 0, rang: "commune", achete: false },
            { name: "Chevrolet Camaro ZL1", baseCost: 5600, cps: 180, count: 0, rang: "commune", achete: false },
            { name: "BMW M4", baseCost: 7000, cps: 230, count: 0, rang: "commune", achete: false },
            { name: "Lotus Elise", baseCost: 9000, cps: 300, count: 0, rang: "commune", achete: false },
        ];

        const carsRares = [
            { type: "separator", label: "üèéÔ∏è Rares" },
            { name: "Ferrari F8 Tributo", baseCost: 12000, cps: 400, count: 0, rang: "rare", achete: false },
            { name: "Lamborghini Aventador", baseCost: 18000, cps: 600, count: 0, rang: "rare", achete: false },
            { name: "Porsche 911 GT3 RS", baseCost: 25000, cps: 850, count: 0, rang: "rare", achete: false },
            { name: "McLaren 720S", baseCost: 35000, cps: 1200, count: 0, rang: "rare", achete: false },
            { name: "Maserati MC20", baseCost: 50000, cps: 1600, count: 0, rang: "rare", achete: false },
            { name: "Audi RS7", baseCost: 70000, cps: 2100, count: 0, rang: "rare", achete: false },
            { name: "Jaguar F-Type SVR", baseCost: 95000, cps: 2700, count: 0, rang: "rare", achete: false },
            { name: "Corvette C8 Z06", baseCost: 125000, cps: 3500, count: 0, rang: "rare", achete: false },
            { name: "Lexus LFA", baseCost: 160000, cps: 4500, count: 0, rang: "rare", achete: false },
            { name: "Alpine A110S", baseCost: 200000, cps: 6000, count: 0, rang: "rare", achete: false },
            { name: "BMW M2 Competition", baseCost: 250000, cps: 7500, count: 0, rang: "rare", achete: false },
            { name: "Toyota GR Yaris", baseCost: 300000, cps: 9000, count: 0, rang: "rare", achete: false },
            { name: "Peugeot 508 PSE", baseCost: 360000, cps: 11000, count: 0, rang: "rare", achete: false },
            { name: "Cupra Formentor VZ5", baseCost: 420000, cps: 13000, count: 0, rang: "rare", achete: false },
            { name: "Alfa Romeo Giulia Quadrifoglio", baseCost: 500000, cps: 16000, count: 0, rang: "rare", achete: false },
            { name: "Honda NSX (2022)", baseCost: 600000, cps: 20000, count: 0, rang: "rare", achete: false },
            { name: "BMW M5 CS", baseCost: 750000, cps: 25000, count: 0, rang: "rare", achete: false },
        ];

        const carsEpique = [
            { type: "separator", label: "üî• √âpiques" },
            { name: "Ferrari LaFerrari", baseCost: 1_000_000, cps: 40000, count: 0, rang: "√©pique", achete: false },
            { name: "Porsche 918 Spyder", baseCost: 1_400_000, cps: 55000, count: 0, rang: "√©pique", achete: false },
            { name: "Mercedes SLR McLaren", baseCost: 2_000_000, cps: 75000, count: 0, rang: "√©pique", achete: false },
            { name: "Aston Martin Vulcan", baseCost: 3_000_000, cps: 110000, count: 0, rang: "√©pique", achete: false },
            { name: "Pagani Utopia", baseCost: 4_200_000, cps: 150000, count: 0, rang: "√©pique", achete: false },
            { name: "Ferrari SF90 Stradale", baseCost: 6_000_000, cps: 210000, count: 0, rang: "√©pique", achete: false },
            { name: "Lamborghini Hurac√°n Performante", baseCost: 8_500_000, cps: 280000, count: 0, rang: "√©pique", achete: false },
            { name: "Ford GT (2017)", baseCost: 12_000_000, cps: 380000, count: 0, rang: "√©pique", achete: false },
            { name: "Rimac Nevera", baseCost: 16_000_000, cps: 500000, count: 0, rang: "√©pique", achete: false },
            { name: "Lotus Evija", baseCost: 22_000_000, cps: 650000, count: 0, rang: "√©pique", achete: false },
            { name: "De Tomaso P72", baseCost: 30_000_000, cps: 850000, count: 0, rang: "√©pique", achete: false },
            { name: "BMW i8", baseCost: 40_000_000, cps: 1_100_000, count: 0, rang: "√©pique", achete: false },
            { name: "Tesla Roadster (2023)", baseCost: 55_000_000, cps: 1_400_000, count: 0, rang: "√©pique", achete: false },
            { name: "Nissan GT-R Nismo", baseCost: 70_000_000, cps: 1_800_000, count: 0, rang: "√©pique", achete: false },
            { name: "Zenvo TSR-S", baseCost: 90_000_000, cps: 2_200_000, count: 0, rang: "√©pique", achete: false },
            { name: "Glickenhaus SCG 004S", baseCost: 120_000_000, cps: 2_800_000, count: 0, rang: "√©pique", achete: false },
            { name: "Ferrari 812 Superfast", baseCost: 150_000_000, cps: 3_500_000, count: 0, rang: "√©pique", achete: false },
            { name: "Lamborghini Revuelto", baseCost: 200_000_000, cps: 4_500_000, count: 0, rang: "√©pique", achete: false },
        ];

        const carsLegendaire = [
            { type: "separator", label: "üèÜ L√©gendaires" },
            { name: "Bugatti Chiron", baseCost: 250_000_000, cps: 6_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Aston Martin Valkyrie", baseCost: 350_000_000, cps: 8_500_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "McLaren P1", baseCost: 500_000_000, cps: 12_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Lamborghini Veneno", baseCost: 700_000_000, cps: 16_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Ferrari F40", baseCost: 1_000_000_000, cps: 22_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Porsche 911 GT1 Stra√üenversion", baseCost: 1_400_000_000, cps: 30_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Koenigsegg Agera", baseCost: 2_000_000_000, cps: 40_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Pagani Huayra", baseCost: 3_000_000_000, cps: 55_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Ferrari Enzo", baseCost: 4_000_000_000, cps: 75_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Lamborghini Miura", baseCost: 5_500_000_000, cps: 100_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Ford GT40", baseCost: 7_000_000_000, cps: 130_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Porsche Carrera GT", baseCost: 9_000_000_000, cps: 160_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Renault R.S.01", baseCost: 12_000_000_000, cps: 200_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Porsche 959", baseCost: 15_000_000_000, cps: 250_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Jaguar XJ220", baseCost: 18_000_000_000, cps: 300_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "BMW M1", baseCost: 22_000_000_000, cps: 360_000_000, count: 0, rang: "l√©gendaire", achete: false },
            { name: "Lancia Stratos", baseCost: 26_000_000_000, cps: 430_000_000, count: 0, rang: "l√©gendaire", achete: false },
        ];

        const carsMythique = [
            { type: "separator", label: "üåå Mythiques" },
            { name: "Mercedes AMG ONE", baseCost: 30_000_000_000, cps: 500_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Bugatti Tourbillon", baseCost: 40_000_000_000, cps: 700_000_000, count: 0, rang: "mythique", achete: false },
            { name: "McLaren F1", baseCost: 55_000_000_000, cps: 1_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Koenigsegg Jesko", baseCost: 70_000_000_000, cps: 1_400_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Koenigsegg Jesko Absolute", baseCost: 90_000_000_000, cps: 1_800_000_000, count: 0, rang: "mythique", achete: false },
            { name: "SSC Tuatara", baseCost: 120_000_000_000, cps: 2_400_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Bugatti Veyron Super Sport", baseCost: 160_000_000_000, cps: 3_200_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Hennessey Venom F5", baseCost: 200_000_000_000, cps: 4_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Apollo IE", baseCost: 250_000_000_000, cps: 5_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Devel Sixteen", baseCost: 300_000_000_000, cps: 6_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Ferrari 250 GTO", baseCost: 400_000_000_000, cps: 8_500_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Lotus Type 66", baseCost: 500_000_000_000, cps: 11_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Czinger 21C", baseCost: 650_000_000_000, cps: 14_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Mazda 787B", baseCost: 787_000_000_000, cps: 16_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Ferrari Vision Gran Turismo", baseCost: 800_000_000_000, cps: 18_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Pininfarina Battista", baseCost: 1_000_000_000_000, cps: 23_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Delage D12", baseCost: 1_200_000_000_000, cps: 28_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Ruf CTR3", baseCost: 1_400_000_000_000, cps: 34_000_000_000, count: 0, rang: "mythique", achete: false },
            { name: "Lamborghini SC20", baseCost: 1_700_000_000_000, cps: 40_000_000_000, count: 0, rang: "mythique", achete: false },
        ];

        // Fusionner toutes les voitures en un seul tableau
        const cars = [
            ...carsCommunes,
            ...carsRares,
            ...carsEpique,
            ...carsLegendaire,
            ...carsMythique
        ];

        function getGarage() {
            return cars.filter(car => car.count > 0 && !car.type);
        }

        const upgrades = [
            { name: "Turbo niv.1 üëÜ", cost: 100, effect: () => { baseClickValue *= 1.2; }, desc: "Un petit coup de boost au d√©marrage" },
            { name: "Turbo niv.2 üëÜ", cost: 500, effect: () => { baseClickValue *= 1.2; }, desc: "Encore plus de punch dans vos clics" },
            { name: "Pilote Amateur üèéÔ∏è", cost: 650, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Un pilote motiv√© pour booster vos gains" },
            { name: "Transmission sportive ‚öôÔ∏è", cost: 1000, effect: () => { baseClickValue *= 1.25; }, desc: "Une transmission qui r√©agit vite" },
            { name: "Systeme Nitro ‚ö°", cost: 1200, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Un petit coup de nitro bien plac√©" },
            { name: "Freinage optimis√© üõë", cost: 1500, effect: () => { baseClickValue *= 1.2; }, desc: "Freinez mieux pour acc√©l√©rer ensuite" },
            { name: "Transmission Course ‚öôÔ∏è", cost: 1600, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Transmission taill√©e pour la course" },
            { name: "Turbo niv.3 üëÜ", cost: 2500, effect: () => { baseClickValue *= 1.3; }, desc: "Boost suppl√©mentaire pour vos clics" },
            { name: "DRS ‚öôÔ∏è", cost: 3000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Ailes ajust√©es pour glisser plus vite" },
            { name: "Turbo niv.4 üëÜ", cost: 4000, effect: () => { baseClickValue *= 1.35; }, desc: "Turbo puissant pour aller plus loin" },
            { name: "Moteur All√©g√© ‚öôÔ∏è", cost: 5000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Un moteur l√©ger pour plus de r√©activit√©" },
            { name: "Pilote Pro üèéÔ∏è", cost: 5000, effect: () => { baseClickValue *= 1.25; }, desc: "Un vrai pro aux commandes" },
            { name: "Freinage D√©gr√©ssif üõë", cost: 10000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Freinage progressif pour mieux contr√¥ler" },
            { name: "Pit-stop rapide üèÅ", cost: 10000, effect: () => { baseClickValue *= 1.3; }, desc: "Arr√™ts aux stands efficaces" },
            { name: "Publicit√© üì∫", cost: 12000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Faites parler de vous partout" },
            { name: "Turbo niv.5 üëÜ", cost: 15000, effect: () => { baseClickValue *= 1.4; }, desc: "Le turbo ultime pour vos clics" },
            { name: "Aero Actif üèéÔ∏è", cost: 15000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "A√©rodynamique qui booste la vitesse" },
            { name: "Infos Ing√© üéôÔ∏è", cost: 15000, effect: () => { baseClickValue *= 1.35; }, desc: "Conseils ing√©nieux pour avancer" },
            { name: "ERS ‚ö°", cost: 35000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "√ânergie r√©cup√©r√©e pour un coup de pouce" },
            { name: "Pilote L√©gendaire üèéÔ∏è", cost: 40000, effect: () => { baseClickValue *= 1.4; }, desc: "Une l√©gende pour inspirer vos gains" },
            { name: "Pneus Hard üõû", cost: 40000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Pneus r√©sistants pour plus de stabilit√©" },
            { name: "Pneus Medium üõû", cost: 40000, effect: () => { baseClickValue *= 1.35; }, desc: "Pneus √©quilibr√©s pour la performance" },
            { name: "Chassi Aluminium üöó", cost: 45000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Un ch√¢ssis l√©ger et solide" },
            { name: "Plaquette De Freins Course ‚öôÔ∏è", cost: 50000, effect: () => { baseClickValue *= 1.4; }, desc: "Un bon freinage pour une bonne acc√©l√©ration" },
            { name: "Chassi Fibre De Carbon üöó", cost: 55000, effect: () => { totalCPS += Math.floor(totalCPS * 0.05); }, desc: "Un ch√¢ssis ultra l√©ger pour plus de vitesse" },
            { name: "Moteur hybride ‚ö°", cost: 60000, effect: () => { baseClickValue *= 1.45; }, desc: "Puissance hybride pour une course efficace" },
            { name: "Superchargeur ‚ö°", cost: 100000, effect: () => { totalCPS += Math.floor(totalCPS * 0.10); }, desc: "Un moteur surpuissant pour booster vos gains passifs" },
            { name: "Pneus Soft üõû", cost: 100000, effect: () => { totalCPS += Math.floor(totalCPS * 0.10); }, desc: "Pneus ultra adh√©rents pour des virages serr√©s" },
            { name: "Sponsor üí∞", cost: 200000, effect: () => { baseClickValue *= 1.5; }, desc: "Soutien financier pour progresser" },
            { name: "Carrosserie Titane üõ°Ô∏è", cost: 250000, effect: () => { baseClickValue *= 1.6; }, desc: "Une carrosserie ultra l√©g√®re pour des clics plus rentables" },
            { name: "Equipe d'Ing√©nieurs üë®‚Äçüîß", cost: 500000, effect: () => { totalCPS += Math.floor(totalCPS * 0.10); }, desc: "Des experts pour optimiser tous vos revenus" },
            { name: "ECU üíª", cost: 1200000, effect: () => { baseClickValue *= 1.8; }, desc: "Informatique optimis√© pour chaque action pour des clics surpuissants" },
            { name: "Max Verstappen üèéÔ∏è", cost: 3300000, effect: () => { totalCPS += Math.floor(totalCPS * 0.10); }, desc: "Un pilote rapide et pr√©cis" },
            { name: "Usine automatis√©e üè≠", cost: 5000000, effect: () => { totalCPS += Math.floor(totalCPS * 0.10); }, desc: "Production automatis√©e pour des revenus passifs doubl√©s" },
            { name: "ConceptCar üöÄ", cost: 20000000, effect: () => { baseClickValue *= 2; }, desc: "Un concept r√©volutionnaire qui multiplie vos clics" },
            { name: "Ayrton Senna üèéÔ∏è", cost: 27000000, effect: () => { baseClickValue *= 1.6; }, desc: "Une l√©gende du volant pour vous guider" },
            { name: "Recherches Avanc√©es üß™", cost: 500000000, effect: () => { baseClickValue *= 2.5; }, desc: "Des innovations pour des clics ph√©nom√©naux" },
            { name: "Partenariat mondial üåç", cost: 2000000000, effect: () => { totalCPS += Math.floor(totalCPS * 0.15); }, desc: "Un r√©seau international pour tripler vos revenus passifs" },
            { name: "Lewis Hamilton üèéÔ∏è", cost: 4400000000, effect: () => { totalCPS += Math.floor(totalCPS * 0.15); }, desc: "Un champion pour maximiser vos gains" },
        ];

        function getAmeliorations() {
            return upgrades.filter(u => u.bought);
        }

        const tracks = [
            // Circuits faciles / vitesse pure
            { name: "Red Bull Ring", cost: 25000, effect: () => { totalCPS += 200; } },
            { name: "Monza", cost: 50000, effect: () => { totalCPS += 800; } },
            { name: "Circuit Paul Ricard", cost: 100000, effect: () => { totalCPS += 1200; } },
            { name: "Silverstone", cost: 150000, effect: () => { totalCPS += 1500; } },
            { name: "Suzuka", cost: 180000, effect: () => { totalCPS += 1600; } },
            { name: "Autodromo Nazionale di Monza GP", cost: 200000, effect: () => { totalCPS += 1700; } },
            { name: "Circuit de Zandvoort", cost: 220000, effect: () => { totalCPS += 1800; } },

            // Circuits moyens / techniques
            { name: "Daytona International Speedway", cost: 200000, effect: () => { totalCPS += 1800; } },
            { name: "Sebring International Raceway", cost: 250000, effect: () => { totalCPS += 2000; } },
            { name: "Fuji Speedway", cost: 300000, effect: () => { totalCPS += 2200; } },
            { name: "Circuit des Am√©riques ‚Äì Austin", cost: 350000, effect: () => { totalCPS += 2400; } },
            { name: "Imola ‚Äì Autodromo Enzo e Dino Ferrari", cost: 400000, effect: () => { totalCPS += 2500; } },
            { name: "Hungaroring", cost: 420000, effect: () => { totalCPS += 2600; } },
            { name: "Circuit de Baku ", cost: 450000, effect: () => { totalCPS += 2700; } },

            // Circuits difficiles / tr√®s techniques
            { name: "Spa-Francorchamps", cost: 400000, effect: () => { totalCPS += 2700; } },
            { name: "Le Castellet ‚Äì Paul Ricard", cost: 500000, effect: () => { totalCPS += 3100; } },
            { name: "Circuit de Monaco", cost: 550000, effect: () => { totalCPS += 3300; } },
            { name: "Interlagos ‚Äì Aut√≥dromo Jos√© Carlos Pace", cost: 600000, effect: () => { totalCPS += 3500; } },
            { name: "Circuit de Barcelone-Catalogne", cost: 700000, effect: () => { totalCPS += 4000; } },
            { name: "Circuit de Shanghai", cost: 750000, effect: () => { totalCPS += 4200; } },
            { name: "Circuit de Singapour", cost: 800000, effect: () => { totalCPS += 4400; } },
            { name: "Circuit de Melbourne ‚Äì Albert Park", cost: 850000, effect: () => { totalCPS += 4600; } },

            // Circuits mythiques / l√©gendaires
            { name: "Brands Hatch", cost: 1200000, effect: () => { totalCPS += 5200; } },
            { name: "Hockenheimring", cost: 1300000, effect: () => { totalCPS += 5400; } },
            { name: "Abu Dhabi Yas Marina", cost: 1500000, effect: () => { totalCPS += 5600; } },
            { name: "Bahrain International Circuit", cost: 1600000, effect: () => { totalCPS += 5800; } },
            { name: "Le Mans", cost: 24000000, effect: () => { totalCPS += 6500; } },
            { name: "Nurb√ºrgring Nordschleife", cost: 1000000000, effect: () => { totalCPS += 8000; } },

        ];

        function getCircuits() {
            return tracks.filter(t => t.bought);
        }

        function getCarsByRang(rang) {
            return cars.filter(car => car.rang === rang && car.name);
        }

        function hasAllCarsOfRang(rang) {
            return getCarsByRang(rang).every(car => getGarage().some(v => v.name === car.name));
        }

        const succes = [
            { nom: "Premier Clic", description: "Clicker 1 fois.", condition: () => totalClicks >= 1, obtenu: false },
            { nom: "Premier Achat", description: "Acheter votre premi√®re voiture", condition: () => getGarage().length >= 1, obtenu: false },
            { nom: "Petit Revenus", description: "Gagner 10 cr√©dits par seconde", condition: () => totalCPS >= 10, obtenu: false },
            { nom: "D√©but Modeste", description: "Avoir 100 cr√©dits en banque", condition: () => credits >= 100, obtenu: false },
            { nom: "Am√©lioration", description: "Acheter votre premi√®re am√©lioration", condition: () => getAmeliorations().length >= 1, obtenu: false },
            { nom: "Doigts Rapides", description: "Clicker 100 fois", condition: () => totalClicks >= 100, obtenu: false },
            { nom: "Collectionneur", description: "Acheter 5 voitures diff√©rentes", condition: () => getGarage().length >= 5, obtenu: false },
            { nom: "Investisseur", description: "Gagner 100 cr√©dits par seconde", condition: () => totalCPS >= 100, obtenu: false },
            { nom: "Petit Budget", description: "Avoir 1 000 cr√©dits en banque", condition: () => credits >= 1000, obtenu: false },
            { nom: "Tuning", description: "Acheter 10 am√©liorations", condition: () => getAmeliorations().length >= 10, obtenu: false },
            { nom: "Accro du Clic", description: "Clicker 1 000 fois", condition: () => totalClicks >= 1000, obtenu: false },
            { nom: "Machine √† Clics", description: "Clicker 1M fois", condition: () => totalClicks >= 1_000_000, obtenu: false },
            { nom: "Fortune", description: "Avoir 1M de cr√©dits en banque", condition: () => credits >= 1000000, obtenu: false },
            { nom: "Doigts infatigables", description: "Clicker 1B fois", condition: () => totalClicks >= 1_000_000_000, obtenu: false },
            { nom: "Magnat", description: "Gagner 1 000 cr√©dits par seconde", condition: () => totalCPS >= 1000, obtenu: false },
            { nom: "Tycoon", description: "Gagner 10 000 cr√©dits par seconde", condition: () => totalCPS >= 10000, obtenu: false },
            { nom: "Millionnaire", description: "Gagner 1M cr√©dits par seconde", condition: () => totalCPS >= 1_000_000, obtenu: false },
            { nom: "Fortune", description: "Avoir 1B de cr√©dits en banque", condition: () => credits >= 1000000, obtenu: false },
            { nom: "Milliardaire", description: "Gagner 1B cr√©dits par seconde", condition: () => totalCPS >= 1_000_000_000, obtenu: false },
            { nom: "Premier Tour", description: "Acheter votre premier circuit", condition: () => getCircuits().length >= 1, obtenu: false },
            { nom: "√âlite", description: "Acheter une voiture √©pique", condition: () => getGarage().some(v => v.rang === "√©pique"), obtenu: false },
            { nom: "L√©gende Vivante", description: "Acheter une voiture l√©gendaire", condition: () => getGarage().some(v => v.rang === "l√©gendaire"), obtenu: false },
            { nom: "Mythe Automobile", description: "Acheter une voiture mythique", condition: () => getGarage().some(v => v.rang === "mythique"), obtenu: false },
            { nom: "Garage Universel", description: "Poss√©der une voiture de chaque cat√©gorie", condition: () => ["commune", "rare", "√©pique", "l√©gendaire", "mythique"].every(rang => getGarage().some(v => v.rang === rang)), obtenu: false },
            { nom: "L'Enfer Vert", description: "Acheter le circuit du Nurb√ºrgring", condition: () => getCircuits().some(v => v.name === "Nurb√ºrgring Nordschleife"), obtenu: false },
            { nom: "Les 24 Heures", description: "Acheter le circuit du Mans", condition: () => getCircuits().some(v => v.name === "Le Mans"), obtenu: false },
            { nom: "Collection Commune", description: "Obtenir toutes les voitures communes", condition: () => hasAllCarsOfRang("commune"), obtenu: false },
            { nom: "Collection Rare", description: "Obtenir toutes les voitures rares", condition: () => hasAllCarsOfRang("rare"), obtenu: false },
            { nom: "Collection √âpique", description: "Obtenir toutes les voitures √©piques", condition: () => hasAllCarsOfRang("√©pique"), obtenu: false },
            { nom: "Collection L√©gendaire", description: "Obtenir toutes les voitures l√©gendaires", condition: () => hasAllCarsOfRang("l√©gendaire"), obtenu: false },
            { nom: "Collection Mythique", description: "Obtenir toutes les voitures mythiques", condition: () => hasAllCarsOfRang("mythique"), obtenu: false },
            { nom: "Une 3 places", description: "Obtenir la McLaren F1", condition: () => getGarage().some(v => v.name === "McLaren F1"), obtenu: false },
            { nom: "Moteur Wankel", description: "Obtenir la Mazda 787B", condition: () => getGarage().some(v => v.name === "Mazda 787B"), obtenu: false },
            { nom: "Au Complet", description: "Acheter toutes les voitures", condition: () => cars.filter(c => !c.type).every(c => c.count > 0), obtenu: false },
            { nom: "Strict N√©cessaire", description: "Acheter toutes les am√©liorations", condition: () => upgrades.every(u => u.bought), obtenu: false },
            { nom: "Tour du Monde", description: "Acheter tous les circuits", condition: () => tracks.every(t => t.bought), obtenu: false },
            { nom: "Tu Tu Tu Du", description: "Simply Lovely", condition: () => getAmeliorations().some(v => v.name === "Max Verstappen üèéÔ∏è"), obtenu: false },
            { nom: "Sir Lewis Hamilton", description: "through goes hamilton", condition: () => getAmeliorations().some(v => v.name === "Lewis Hamilton üèéÔ∏è"), obtenu: false },
        ];

        function resetGame() {
            if (confirm("‚ö†Ô∏è Voulez-vous vraiment r√©initialiser votre partie ?")) {
                // Supprimer la sauvegarde
                localStorage.removeItem("hypercarSave");

                // R√©initialiser toutes les variables
                credits = 0;
                totalCPS = 0;
                baseClickValue = 1;
                totalClicks = 0;
                totalPlayTime = 0;
                lastSessionStart = Date.now();
                nbGoldenWheelClicked = 0;
                totalCarsOwned = 0;

                // R√©initialiser les voitures
                [...carsCommunes, ...carsRares, ...carsEpique, ...carsLegendaire, ...carsMythique].forEach(c => {
                    if (c.count !== undefined) c.count = 0;
                    if (c.achete !== undefined) c.achete = false;
                });

                // R√©initialiser les am√©liorations
                upgrades.forEach(u => u.bought = false);

                // R√©initialiser les circuits
                tracks.forEach(t => t.bought = false);

                // R√©initialiser les succ√®s
                succes.forEach(s => s.obtenu = false);
                showStats('success'); // Met √† jour l'affichage des succ√®s

                // R√©initialiser l'affichage
                updateCreditsDisplay();
                updateStatsDisplay();
                renderShop();

                openTab('main');
            }
        }

        function saveGame() {
            const elapsedThisSession = Math.floor((Date.now() - lastSessionStart) / 1000);

            const saveData = {
                credits,
                totalCPS,
                baseClickValue,
                totalClicks,
                carsCommunes: carsCommunes.map(c => ({ count: c.count || 0 })),
                carsRares: carsRares.map(c => ({ count: c.count || 0 })),
                carsEpique: carsEpique.map(c => ({ count: c.count || 0 })),
                carsLegendaire: carsLegendaire.map(c => ({ count: c.count || 0 })),
                carsMythique: carsMythique.map(c => ({ count: c.count || 0 })),
                upgrades: upgrades.map(upg => ({ bought: !!upg.bought })),
                tracks: tracks.map(trk => ({ bought: !!trk.bought })),
                lastSave: Date.now(),
                totalPlayTime: (totalPlayTime || 0) + elapsedThisSession,
                succes: succes.map(s => ({ obtenu: !!s.obtenu })),
                nbGoldenWheelClicked: nbGoldenWheelClicked,
                totalCarsOwned,

            };
            localStorage.setItem("hypercarSave", JSON.stringify(saveData));
        }

        function loadGame() {
            const saved = localStorage.getItem("hypercarSave");
            if (!saved) return;

            const data = JSON.parse(saved);

            // Bonus hors-ligne
            const offlineTime = Math.floor((Date.now() - (data.lastSave || Date.now())) / 1000);
            const offlineCredits = (data.totalCPS || 0) * offlineTime;
            if (offlineCredits > 0) {
                alert(`Vous avez gagn√© ${formatNumber(offlineCredits)} cr√©dits hors ligne !`);
            }

            credits = (data.credits || 0) + offlineCredits;
            totalCPS = data.totalCPS || 0;
            baseClickValue = data.baseClickValue || 1;
            totalPlayTime = data.totalPlayTime || 0;
            totalClicks = data.totalClicks || 0;
            lastSessionStart = Date.now();
            nbGoldenWheelClicked = data.nbGoldenWheelClicked || 0;
            totalCarsOwned = data.totalCarsOwned || 0;

            // üî• Restaurer chaque tableau s√©par√©ment
            if (data.carsCommunes) data.carsCommunes.forEach((c, i) => { if (carsCommunes[i]) carsCommunes[i].count = c.count || 0; });
            if (data.carsRares) data.carsRares.forEach((c, i) => { if (carsRares[i]) carsRares[i].count = c.count || 0; });
            if (data.carsEpique) data.carsEpique.forEach((c, i) => { if (carsEpique[i]) carsEpique[i].count = c.count || 0; });
            if (data.carsLegendaire) data.carsLegendaire.forEach((c, i) => { if (carsLegendaire[i]) carsLegendaire[i].count = c.count || 0; });
            if (data.carsMythique) data.carsMythique.forEach((c, i) => { if (carsMythique[i]) carsMythique[i].count = c.count || 0; });

            if (data.upgrades) data.upgrades.forEach((u, i) => { if (upgrades[i]) upgrades[i].bought = !!u.bought; });
            if (data.tracks) data.tracks.forEach((t, i) => { if (tracks[i]) tracks[i].bought = !!t.bought; });

            if (data.succes) data.succes.forEach((s, i) => { if (succes[i]) succes[i].obtenu = !!s.obtenu; });

            updateCreditsDisplay();
            renderShop();
            updateStatsDisplay();
        }

        function formatNumber(num) {
            num = Math.trunc(num);
            if (num >= 1e21) return (num / 1e21).toFixed(1).replace(/\.0$/, "") + "Sx";
            if (num >= 1e18) return (num / 1e18).toFixed(1).replace(/\.0$/, "") + "Qi";
            if (num >= 1e15) return (num / 1e15).toFixed(1).replace(/\.0$/, "") + "Q";
            if (num >= 1e12) return (num / 1e12).toFixed(1).replace(/\.0$/, "") + "T";
            if (num >= 1e9) return (num / 1e9).toFixed(1).replace(/\.0$/, "") + "B";
            if (num >= 1e6) return (num / 1e6).toFixed(1).replace(/\.0$/, "") + "M";
            if (num >= 1e3) return (num / 1e3).toFixed(1).replace(/\.0$/, "") + "K";
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }

        function formatTime(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;
            return (h > 0 ? `${h}h ` : "") + (m > 0 ? `${m}m ` : "") + `${s}s`;
        }

        function updateCreditsDisplay() {
            cpcdisplay = Math.trunc(baseClickValue * 100) / 100;
            document.getElementById("credits").innerText = "Cr√©dits : " + formatNumber(credits);
            document.getElementById("cpcDisplay").innerText = "Cr√©dits par clic : " + formatNumber(cpcdisplay);
            document.getElementById("cpsDisplay").innerText = "CPS total : " + formatNumber(totalCPS);
        }

        function updateStatsDisplay() {
            document.getElementById("total-clicks").innerText = totalClicks;
            document.getElementById("total-cps").innerText = formatNumber(totalCPS);
            document.getElementById("total-cpc").innerText = formatNumber(cpcdisplay);
            document.getElementById("nbGoldenWheelClicked").innerText = formatNumber(nbGoldenWheelClicked);
            document.getElementById("totalCarsOwned").innerText = formatNumber(totalCarsOwned);

            const elapsedThisSession = Math.floor((Date.now() - lastSessionStart) / 1000);
            const total = (totalPlayTime || 0) + elapsedThisSession;

            document.getElementById("total-time").innerText = formatTime(total);
        }

        function renderShop() {
            // Voitures
            const carDiv = document.getElementById("cars");
            carDiv.innerHTML = "";
            cars.forEach((car) => {
                if (car.type === "separator") {
                    const sep = document.createElement("div");
                    sep.className = "separator";
                    sep.textContent = car.label;
                    carDiv.appendChild(sep);
                } else {
                    const cost = Math.floor(car.baseCost * Math.pow(1.15, car.count));
                    const card = document.createElement("div");
                    card.className = "card";
                    card.innerHTML = `
                                                                                                            <p>
                                                                                                                ${car.name}<br>
                                                                                                                üí∞ ${formatNumber(cost)}<br>
                                                                                                                üöó ${car.count}<br>
                                                                                                                ‚ö° CPS unitaire : ${formatNumber(car.cps)}<br> <!-- üÜï Ligne ajout√©e -->
                                                                                                                ‚ö° CPS total : ${formatNumber(car.count * car.cps)}
                                                                                                            </p>
`;
                    card.onclick = () => {
                        if (credits >= cost) {
                            credits -= cost;
                            car.count++;
                            totalCPS += car.cps;
                            totalCarsOwned++;

                            // üéØ Bonus sp√©cial pour la Porsche Cayman
                            if (car.name === "Fiat 500 Abarth") {
                                baseClickValue += car.count / 20;
                            }

                            updateCreditsDisplay();
                            renderShop();
                            saveGame();
                            verifierSucces();
                        }
                    }
                    carDiv.appendChild(card);
                }
            });

            // Am√©liorations
            const upgDiv = document.getElementById("upgrades");
            upgDiv.innerHTML = "";
            upgrades.forEach((upg) => {
                if (!upg.bought) {
                    const card = document.createElement("div");
                    card.className = "card";
                    card.innerHTML = `<p>${upg.name}<br>üí∞ ${formatNumber(upg.cost)}<br>${upg.desc}</p>`;
                    card.onclick = () => {
                        if (credits >= upg.cost) {
                            credits -= upg.cost;
                            upg.bought = true;
                            upg.effect();
                            updateCreditsDisplay();
                            renderShop();
                            saveGame();
                            verifierSucces();
                        }
                    }
                    upgDiv.appendChild(card);
                }
            });

            // Circuits
            const trkDiv = document.getElementById("tracks");
            trkDiv.innerHTML = "";
            tracks.forEach((trk) => {
                if (!trk.bought) {
                    const card = document.createElement("div");
                    card.className = "track-card";
                    card.innerHTML = `<p>${trk.name}<br>üí∞ ${formatNumber(trk.cost)}<br>${trk.desc ? trk.desc : ""}</p>`;
                    card.onclick = () => {
                        if (credits >= trk.cost) {
                            credits -= trk.cost;
                            trk.bought = true;
                            trk.effect();
                            updateCreditsDisplay();
                            renderShop();
                            saveGame();
                            verifierSucces();
                        }
                    }
                    trkDiv.appendChild(card);
                }
            });
        }

        const clickArea = document.getElementById("clickArea");

        // Modifier la fonction handleClick pour compter les clics
        function handleClick(e) {
            e.preventDefault();
            totalClicks++;
            const gain = Math.round(baseClickValue * 100) / 100;
            credits += gain;
            updateCreditsDisplay();
            updateStatsDisplay();

            const floating = document.createElement("span");
            floating.className = "floating-text";
            floating.innerText = "+" + formatNumber(gain);

            const rect = clickArea.getBoundingClientRect();
            let x, y;

            if (e.touches) { // mobile
                x = e.touches[0].clientX - rect.left;
                y = e.touches[0].clientY - rect.top;
            } else { // desktop
                x = e.clientX - rect.left;
                y = e.clientY - rect.top;
            }

            floating.style.left = x + "px";
            floating.style.top = y + "px";
            clickArea.appendChild(floating);

            setTimeout(() => floating.remove(), 1000);
            verifierSucces();
        }

        clickArea.addEventListener("click", handleClick);
        clickArea.addEventListener("touchstart", handleClick);

        // Cr√©dit passif chaque seconde
        setInterval(() => {
            credits += totalCPS;
            updateCreditsDisplay();
        }, 1000);

        // Sauvegarde auto toutes les 10s
        setInterval(saveGame, 10000);

        // Sauvegarde √† la fermeture / changement d‚Äôonglet
        window.addEventListener('beforeunload', saveGame);
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) saveGame();
        });

        function openTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            window.scrollTo({ top: 0, behavior: "smooth" });
        }

        // Modifie la fonction showStats pour g√©rer le nouveau type "upgrades"
        function showStats(type) {
            const garageDiv = document.getElementById("garage-liste");
            const succesDiv = document.getElementById("liste-succes");
            const upgradesDiv = document.getElementById("liste-upgrades");

            // Toggle : si le menu demand√© est d√©j√† visible, on le cache
            if ((type === "garage" && garageDiv.style.display === "block") ||
                (type === "success" && succesDiv.style.display === "block") ||
                (type === "upgrades" && upgradesDiv.style.display === "block")) {
                garageDiv.style.display = "none";
                succesDiv.style.display = "none";
                upgradesDiv.style.display = "none";
                return;
            }

            // On cache tout d'abord
            garageDiv.style.display = "none";
            succesDiv.style.display = "none";
            upgradesDiv.style.display = "none";

            if (type === "garage") {
                garageDiv.innerHTML = "";
                const voituresAchetees = cars.filter(car => car.count > 0 && !car.type);

                if (voituresAchetees.length === 0) {
                    garageDiv.innerHTML = "<em>Votre garage est vide</em>";
                } else {
                    // Compte le total par cat√©gorie (avec doublons)
                    const classes = {};
                    voituresAchetees.forEach(car => {
                        let classe = "Inconnue";
                        for (let i = cars.indexOf(car) - 1; i >= 0; i--) {
                            if (cars[i].type === "separator") {
                                classe = cars[i].label;
                                break;
                            }
                        }
                        if (!classes[classe]) classes[classe] = 0;
                        classes[classe] += car.count;
                    });

                    for (const classe in classes) {
                        garageDiv.innerHTML += `<strong>${classe}</strong> : ${classes[classe]} voiture(s)<br>`;
                    }
                }
                garageDiv.style.display = "block";
            }
            else if (type === "success") {
                succesDiv.innerHTML = "";
                succes.forEach(s => {
                    const classe = s.obtenu ? "succes-obtenu" : "succes-non-obtenu";
                    succesDiv.innerHTML += `
                                                                                                                        <div class="card ${classe}" style="margin:5px; padding:10px;">
                                                                                                                            <strong>${s.nom}</strong><br>
                                                                                                                            <span>${s.description}</span>
                                                                                                                        </div>
                                                                                                                        `;
                });
                succesDiv.style.display = "block";
            }
            else if (type === "upgrades") {
                upgradesDiv.innerHTML = "";
                const upgradesAchetees = upgrades.filter(u => u.bought);

                if (upgradesAchetees.length === 0) {
                    upgradesDiv.innerHTML = "<em>Aucune am√©lioration acquise</em>";
                } else {
                    upgradesAchetees.forEach(upg => {
                        upgradesDiv.innerHTML += `
                                                                                                                                    <div class="card succes-obtenu" style="margin:5px; padding:10px;">
                                                                                                                                        <strong>${upg.name}</strong><br>
                                                                                                                                        <span>${upg.desc}</span>
                                                                                                                                    </div>
                                                                                                                                `;
                    });
                }
                upgradesDiv.style.display = "block";
            }
        }

        function verifierSucces() {
            succes.forEach(s => {
                if (!s.obtenu && s.condition()) {
                    s.obtenu = true;
                    showSuccesPopup(s.nom);  // tu peux remplacer par une notif styl√©e
                    showStats('success'); // on met √† jour l'affichage
                }
            });
        }

        function showSuccesPopup(nom) {
            const popup = document.createElement("div");
            popup.className = "succes-popup";
            popup.innerText = `üèÜ Succ√®s d√©bloqu√© : ${nom}`;
            document.body.appendChild(popup);
            setTimeout(() => popup.remove(), 2200);
        }

        function spawnGoldenEvent() {
            if (goldenEventActive) return; // √©viter doublons

            goldenEventActive = true;

            // cr√©er un √©l√©ment visuel (ex: logo hypercar dor√©)
            const event = document.createElement("div");
            event.id = "goldenEvent";
            event.innerText = "üõû"; // Ic√¥ne temporaire
            event.style.position = "absolute";

            // Limiter la zone d‚Äôapparition
            const headerHeight = 100; // hauteur de ton header en px
            const availableHeight = window.innerHeight - headerHeight - 100; // marge en bas de 100px
            const top = headerHeight + Math.random() * availableHeight;

            const left = Math.random() * (window.innerWidth - 100); // √©viter hors √©cran

            //event.style.top = top + "px";
            //event.style.left = left + "px";
            event.style.fontSize = "3rem";
            event.style.cursor = "pointer";

            event.style.top = Math.random() * 80 + "%";
            event.style.left = Math.random() * 80 + "%";
            event.style.fontSize = "3rem";
            event.style.cursor = "pointer";
            event.classList.add("golden-event");

            document.body.appendChild(event);

            // click = bonus
            event.addEventListener("click", () => {
                applyGoldenBonus();
                document.body.removeChild(event);
                goldenEventActive = false;
                scheduleNextGolden(); // relance prochaine apparition
            });

            // disparition apr√®s 10s
            setTimeout(() => {
                if (document.body.contains(event)) {
                    document.body.removeChild(event);
                    goldenEventActive = false;
                    scheduleNextGolden();
                }
            }, 10000);
        }

        function applyGoldenBonus() {
            const rand = Math.random();
            if (rand < 0.3) {
                credits += Math.floor(credits * 0.05);
                showBonusPopup("üí∞ +5% cr√©dits !");
                nbGoldenWheelClicked++;
            } else if (rand < 0.6) {
                baseClickValue *= 2;
                document.getElementById("cpcDisplay").classList.add("highlight-boost");
                setTimeout(() => {
                    baseClickValue /= 2;
                    document.getElementById("cpcDisplay").classList.remove("highlight-boost");
                }, 30000);
                showBonusPopup("üñ±Ô∏è CPC doubl√© (30s) !");
                nbGoldenWheelClicked++;
            } else if (rand < 0.95) {
                totalCPS *= 2;
                document.getElementById("cpsDisplay").classList.add("highlight-boost");
                setTimeout(() => {
                    totalCPS /= 2;
                    document.getElementById("cpsDisplay").classList.remove("highlight-boost");
                }, 30000);
                showBonusPopup("‚ö° CPS doubl√© (30s) !");
                nbGoldenWheelClicked++;
            } else {
                credits += 1000000;
                showBonusPopup("üëë Jackpot +1M cr√©dits !");
                nbGoldenWheelClicked++;
            }
        }

        function scheduleNextGolden() {
            const delay = (30 + Math.random() * 90) * 1000; // entre 30 et 120s
            setTimeout(spawnGoldenEvent, delay);
        }

        function showBonusPopup(message) {
            const popup = document.createElement("div");
            popup.className = "bonus-popup";
            popup.innerText = message;
            document.body.appendChild(popup);

            // disparition douce
            setTimeout(() => popup.remove(), 2200);
        }


        // Lancer le premier
        scheduleNextGolden();

        loadGame();
        renderShop();
        updateCreditsDisplay();
        updateStatsDisplay();
        setInterval(updateStatsDisplay, 1000);
        setInterval(verifierSucces, 5000);
    </script>
</body>
</html>

